
\documentclass{article}

\usepackage[spanish]{babel}

\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amsmath}

\title{Ecuaciones en diferencias}

\author{Alumnos de 3er semestre grupo 2}

\date{18 de septiembre de 2017}
 
\begin{document}

\maketitle
\tableofcontents

\section{Ecuaciones en diferencias}
\label{sec:ecuaciones}

En este documento veremos ecuaciones en diferencias, en especial de
primer y segundo orden homógeneas, al igual que la solución de una
ecuación en diferencias no homógenea que se representa como una suma
de una solución homógenea y una particular.  Para dar solución a las
ecuaciones tanto de primer como de segundo orden calcularemos su
polinomio característico. En el caso de las de segundo orden tenemos
los casos en donde tenemos una o dos soluciones y tendremos que
distinguir los casos en donde obtenemos raíces reales distintas, raíces
reales de multiplicidad dos o raíces complejas.

Una ecución en diferencia es de la forma $$X_{n+k}=f(n,X_n,...,X_{n+(k-1)})$$
$k$ es fijo y $n$ varía en $\mathbb{N}\cup\{0\}$

Si en una ecuación en diferencias, la función $f$ no depende de $n$,
la ecuación en diferencias es autónoma.

\section{Ecuaciones de primer orden}

\subsection{Ecuaciones lineales}

Una ecuación lineal en diferencias de primer orden tiene la forma
$x_{n+1}=ax_n$ donde $a$ es una constante.

La fórmula para resolver ecuaciones lineales es:
\begin{equation}
  \label{lineal}
  x_n=a^nx_0.
\end{equation}

Por ejemplo, si iniciamos una inversión con 1000 pesos con un interés
mensual del 1\%, obtenemos la gráfica mostrada en la figura
\ref{inversion}.

\begin{figure}
  \centering
  \includegraphics[width=8cm]{inversion.png}
  \caption{Gráfica de una inversión}
  \label{inversion}
\end{figure}

Estas ecuaciones hacen que una ecuación que inicialmente era de esta
manera: $x_{n+1}=x_n+2x_n$ puede escribirse de manera que la ecuación
solo dependa de $x_n$ y queda $x_{n+1}=3x_n$, cuya solución con
condición inicial $x_0=4$ es la siguiente:
$$x_n=3^n(4).$$

\subsection{Ejemplo}

Nuestro compañerito Pepe muere en raras circunstancias (después de
tener su examen de Álgebra II), luego descubren lo radiante de su
ser. Cada 20 años el elemento radioactivo decae a razón de $2\%$, si
inicialmente contenía 165 gramos de puro amor ¿Cuánto tendrá cuando se
vea un poco más feo (como quien dice, dentro de 60 años)?

\textit{Solución:}  
Sabemos que la condición inicial es de 165 gramos y que decae un $2\%$
cada 20 años, lo cual implica que se mantiene en un $98\%$ con
respecto a al valor anterior, entonces la ecuación de diferencias de
primer orden se ve de la forma:
$$x_{n}=(.98)^n(165).$$

Ahora solo sustituimos la n por el numero deseado, en este caso
buscamos el valor del elemento cuando han pasado 60 años,
equivalentemente a $n=3$, quedando finalmente:
$$x_{3}=(.98)^3(165)= 155.29.$$

\subsection{Ejemplo}

Se esparce nuestro trabajo colaborativo dentro de la universidad. Al
tiempo 0, el trabajo es conocido por 13 personas. Cada día, por
persona que ya lo conoce se le agrega otra (nueva).

Si $X_n$ es la cantidad de personas con información nueva al día $n$,
determinar $X_n$ en términos de $n$ y $X_0$.

\textit{Solución:} La ecuación resolvente está dada por
$X_{n+1}=aX_n$, entonces, tomando $a=2$ y $X_0=13$, tendríamos el
siguiente razonamiento:
\begin{itemize}
\item $X_0=2^013=13$,
\item $X_1=2^113=26$, siguiendo, llegamos a:
\item $X_n=2^n13=a^nX_0$, quedando de esta manera la ecuación resolvente.
\end{itemize}

\section{Ecuaciones de segundo orden}

Hablaremos sobre la ecuación reaolvente.

Una ecuación en diferencias de segundo orden tiene la forma $a_{k+2}=f(a_k,a_{k+1})$.
El método para resolver estas ecuaciones está inspirado en la fórmula \ref{lineal}.

Para resolver una ecuación en diferencias de segundo orden se usa la
ecuación resolvente, la cual se dedujo de la siguiente manera:

En general una ecuación en diferencias de segundo orden se ve de la
siguiente manera $x_{k+2}=px_{k+1}+qx_{k}$, ésto implica que
$x_{k+2}-px_{k+1}-qx_{k}=0$, ahora sean $-p=a$ y $-q=b$. Así:
\begin{equation}
  \label{ecsegorden}
  x_{k+2}+ax_{k+1}+bx_{k}=0,
\end{equation}
con $a$ y $b$ en los reales, entonces cómo ya mencionamos, el método
para resolver éstas ecuaciones está inspirado en la fórmula
\ref{lineal}. Ahora, ¿qué deben cumplir $r$ y~$c$ para que $x_k=cr^k$
sea solución de la ecuación \eqref{ecsegorden}?

Tenemos entonces que: $x_{k+2}=cr^{k+2}$, $x_{k+1}=cr^{k+1}$ y
$x_{k}=cr^{k}$, luego $cr^{k+2}+acr^{k+1}+bcr^k=0$, ésto implica que
$c(r^{k+2}+ar^{k+1}+br^k)=0$, se sigue $r^k(r^2+ar+b)=0$, para todo
$k$, así tenemos que $r^2+ar+b=0$ a la cual llamaremos
\textit{ecuación resolvente} de la ecuación \eqref{ecsegorden} y
$x^k=r^k$ es solución de la ecuación \eqref{ecsegorden}.



\subsection{Dos soluciones distintas}
\label{sec:distintas}
La forma en la que resolvemos una ecuación de segundo orden cuya
ecuación resolvente tenga dos raíces distintas es mediante la
siguiente formula:
\begin{equation}
 \label{raicesdistintas}
 a_n=\lambda_1x_1^n +\lambda_2x_2^n,
\end{equation}
donde $x_1$ y $x_2$ son soluciones de la ecuación de segundo orden y
$\lambda_1$ y $\lambda_2$ son escalares reales.
\subsubsection{Ejemplo}

La ecuación de segundo grado más conocida es la \textit{sucesión de
  Fibonacci}, la cual se ve de la forma:
\begin{equation}
  \label{eq:fibonacci}
a_{k+2}=a_{k+1}+a_{k},  
\end{equation}
en donde usualmente se toman como condiciones iniciales a: $a_{0}=1$ y $a_{1}=1$

Es inmediato calcular los primeros términos, pero ¿cómo calcularlos
cuando los términos son demasiado grandes?  Para obtenerlos,
consideramos la ecuación resolvente que viene de la ecuación original,
la cual se ve de la siguiente manera:
$$r^2-r-1=0$$

Obtenemos después ambas raíces, las cuales son:
$r_{1}= \frac{1+\sqrt{5}}{2}$ y $r_{2}=\frac{1-\sqrt{5}}{2}$. La
solución general es entonces:
$a_{k}=\alpha_{1}(\frac{1+\sqrt{5}}{2})^{k} +
\alpha_{2}(\frac{1-\sqrt{5}}{2})^k$

Ahora resolvemos un sistema de ecuaciones tal que:
$\alpha_{1} + \alpha_{2}= 1$ y
$\alpha_{1}(\frac{1+\sqrt{5}}{2}) + \alpha_{2}(\frac{1+\sqrt{5}}{2})=1$

Para obtener finalmente:
$F_{n}= \frac{5+\sqrt{5}}{10}\frac{(1+\sqrt{5})^n}{2} +
\frac{5-\sqrt{5}}{10}\frac{(1-\sqrt{5})^n}{2}$

\subsubsection{Ejemplo}
\label{sec:fichas}

¿De cuántas maneras se puede cubrir un tablero de $2\times n$ usando
fichas de $1\times 2$ y $2\times 1$?

\textit{Solución:} Sea $a_n$ la cantidad de maneras con las cuales se
puede cubrir el tablero $2\times n$. Ahora, si tenemos un tablero
$2\times (n+1)$, observemos que hay una sola manera de cubrir la
casilla que se le agregó y esta es usando una ficha $2\times 1$.
Después utilizando el mismo razonamiento con un tablero
$2\times (n+2)$ tenemos que las dos casillas agregadas se pueden
cubrir de 2 formas, sin embargo, una es usando fichas $1\times 2$ y la
otra es usando fichas $2\times 1$, la cual ya se contempló en el caso
anterior. Por lo tanto solo consideramos el caso restante, obteniendo
así la siguiente ecuación en diferencias de segundo orden:
$a_{n+2}=a_{n+1}+a_n$.  Por la ecuación \eqref{eq:fibonacci}, tenemos
que
$a_n=\frac{5+\sqrt{5}}{10}\frac{(1+\sqrt{5})^n}{2} +
\frac{5-\sqrt{5}}{10}\frac{(1-\sqrt{5})^n}{2}$.


%% 


\subsection{Una única solución}
\label{sec:unica}

Para resolver una ecuación en diferencias de segundo orden cuya
ecuación resolvente tenga dos raíces iguales usamos la siguiente fórmula:
\begin{equation}
 \label{raicesiguales}
 a_n=\lambda_1x_1^n +\lambda_2nx_2^n,
\end{equation}
donde $r_1=r_2$ son soluciones de la ecuación de segundo orden y
$\alpha_1$ y $\alpha_2$ son escalares reales.

\subsubsection{Ejemplo}

En la siguiente ecuación en diferencias
\begin{equation}
  \label{eq:1}
  x_{n+2}=4x_{n+1}-4x_{n}
\end{equation}
veremos que la ecuación resolvente $r^2-4r+4=0$ tiene una sola raíz, a
saber: $r=2$.

La solución general es entonces:
$$x_n=\alpha_12^n+\alpha_2n2^n$$
y a continuación se deben considerar los valores iniciales para que
nos dé los valores de $\alpha_1$ y $\alpha_2$.

\subsubsection{Ejemplo}

Se plantea la siguiente ecuación en diferencias:
$a_{n+2}=2a_{n+1}-a_{n}$ con condiciones iniciales: $a_{0}=4, a_{1}=7$.

Para resolver este problema, primero igualamos la ecuación en diferencias a
cero: $a_{n+2}-2a_{n+1}+a_{n}=0$.

Esto último nos genera una ecuación resolvente. Al factorizarlos y
resolverlo se obtiene: $r^2-2r+1=0$, ${(r-1)^2=0}$, ${r=1}$.

La solución general a esta ecuación en diferencias sería:

$$a_{n}=\alpha_{1}(1)^n+n\alpha_{2}(1)^n=\alpha_{1}+n\alpha_{2}$$

Sin embargo, el problema nos da condiciones iniciales
específicas. Entonces procedemos a plantear un sistema de ecuaciones
para poder satisfacer las condiciones iniciales.
\begin{align*}
  a_{0}&=4=\alpha_{1}(1)^0+0\alpha_{2}(1)^0\\
  a_{1}&=7=\alpha_{1}(1)^1+1\alpha_{2}(1)^1
\end{align*}

Al resolver lo anterior obtenemos los siguientes valores:
$\alpha_{1}=4$ y $\alpha_{2}=3$, con lo que la solución final será:
$a_{n}=4+3n$.


\subsection{Los números  complejos}

Un \textit{complejo} es un número de la forma $z=a+bi$, $a,b\in\mathbb{R}$ ,
con $i^2=-1$, y donde $a$ recibe el nombre de \textit{parte real} y $b$ el de
\textit{parte imaginaria}

El \textit{módulo} de un número complejo se define como:
$|a+bi|=\sqrt{a^2+b^2}$, agarrando las partes reales, el módulo
siempre es positivo.

El \textit{argumento} de un número complejo se denota así: $\arg(z)=\theta$. Es
el ángulo comprendido en el plano tanto en el eje real
($x\in\mathbb{R}$) como el eje imaginario ($y\in\mathbb{R}$).

Para calcularlo decimos que:
$z=|z|*\frac{z}{|z|}$, ahora que tenemos eso podemos ver a $z$ como
$z=\cos(\theta)+i\sin(\theta)$.

Para obtener el valor de $\theta$
necesitamos la siguiente fórmula: $\theta=\arctan(\arg(z))$. Teniendo el
valor de $\theta$ podemos sustituirla en nuestra ecuación principal
$z=\cos(\theta)+i\sin(\theta)$. Para tener una solución en términos de
$n$ tenemos que elevar toda nuestra fórmula a la $n$, es decir
$z^n=(\cos(\theta)+i\sin(\theta))^n$, esto es igual que decir
$z^n=\cos(n\theta)+i\sin(n\theta)$ (utilizando la fórmula de Moivre).

\subsection{Soluciones complejas}
\label{sec:complejas}

Algunas ocasiones las ecuaciones de segundo orden no tendrán solución
en los reales, sin embargo en los complejos sí y no por manejar
números complejos su nivel de dificultad será mayor. Aquí mostramos un
ejemplo de soluciones complejas: 

$x_{n+2}=-4x_{n}$ con $x_0=1$ y $x_1=0$.

La ecuación resolvente es: $r^2+4=0$, la cual tiene raíces complejas.
Resolvemos igual que en ecuaciones de segundo orden entonces aplicamos
la formula general para buscar sus raíces y tenemos: $r=\pm2i$.
Ahora buscaremos su módulo: $|r|=\sqrt{2^2}=2$

Llegado a este punto hacemos uso de la fórmula resolvente y la fórmula de De Moivre para obtener lo siguiente:

$x_n=\lambda_12^n\cos(\frac{n\pi}{2})+\lambda_22^n\sin(\frac{n\pi}{2})$.

Y buscamos el valor de los lambdas con un sistema de ecuaciones:

$\lambda_12^0\cos(\frac{0\pi}{2})+\lambda_22^0\sin(\frac{0\pi}{2})=1$

$\lambda_12^1\cos(\frac{1\pi}{2})+\lambda_22^1\sin(\frac{1\pi}{2})=0$

Al resolver obtenemos los siguientes valores:

$\lambda_1=1;\lambda_2=0$

con lo que la solución final es:

$x_n=2^n\cos(\frac{n\pi}{2})$

Otro ejemplo: $x_{n+2}=4x_{n+1}-8x_n$ con condiciones iniciales
$x_0=1$ y $x_1=0$. Para encontrar sus raíces se lleva a cabo el
procedimiento habitual. En este caso sus raíces son: $r=2\pm2i$

El siguiente paso es encontrar su módulo: $|r|=\sqrt{2^2+2^2}$

%%%% ???????????

\subsubsection{Ejemplo}

Para cada $n$, considera $D_{n}$ el determinante $n\times n$ dado por:

\begin{equation*}
\begin{pmatrix}
0 & 1 & 0 & 0 &\ldots & 0 & 0 & 0 & 0\\
1 & 0 & 1 & 0 &\ldots & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 1 &\ldots & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 &\ldots & 0 & 0 & 0 & 0\\
\ldots\\
0 & 0 & 0 & 0 &\ldots & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 &\ldots & 1 & 0 & 1 & 0\\
0 & 0 & 0 & 0 &\ldots & 0 & 1 & 0 & 1\\
0 & 0 & 0 & 0 &\ldots & 0 & 0 & 1 & 0
\end{pmatrix}
\end{equation*}


Para encontrar $D_{n}$ usamos la ecuación en diferencias que se deduce de observar
que $D_{n}=(0)D_{n-1}-(1)D_{n-2}$ entonces;
\begin{equation}
  \label{determinante}
D_{n}=-D_{n-2}
\end{equation}
 y además $D_{0}=0$ y $D_{1}=-1$.
Resolvamos la ecuación resolvente que es $$r^{2}=-1$$ y asi las soluciones son $y_{n}=i$ y  $z_{n}=-i$.

Veamos que  $|i|=\sqrt{1}=1$ y que $\arg(\theta)$ y $\theta= \frac{\pi}{2}$, de ahí:
$$i=\cos(\frac{\pi}{2})+i\sin(\frac{\pi}{2})$$
Elevando a la $n$ se obtiene
$$i^n=\cos(\frac{\pi}{2})+i\sin(\frac{\pi}{2})$$
Usando la Formula de Moivre se obtiene:
$$i^n=(\cos(\frac{n\pi}{2})+i\sin(\frac{n\pi}{2}))$$

$\cos(\frac{\pi}{2})$ y  $\sin(\frac{\pi}{2})$ son soluciones de la ecuacion en diferencias, entonces: 
$$D_{n}=\lambda_{1}\cos(\frac{n\pi}{2})+\lambda_{2}\sin(\frac{n\pi}{2})$$
Ahora resolvamos un pequeño sistema de ecuaciones para conocer los valores de $\lambda_1$ y $\lambda_2$:
  $$D_{0}=\lambda_{1}(1)+\lambda_{2}(0)=\lambda_{1}=1$$
  $$D_{1}=\lambda_{1}(0)+\lambda_{2}(1)=\lambda_{2}=0$$

Finalmente la solución general a la ecuacion en diferencias es:
\begin{equation}
  \label{solucion determinante}
D_{n}=\cos(\frac{n\pi}{2}).
\end{equation}


\subsection{Ecuaciones de segundo orden no homogéneas}
\label{sec:nohomogeneas}

Para resolver la ecuación representada por la expresión
$$ax_{n+2}+bx_{n+1}+cx_{n}=f(n)$$ debemos sumar una solución particular
del problema no homogéneo a la solución obtenida de resolver la parte
homogénea.

Cuando la solución particular del problema no homogéneo que estamos
presentando también es solución de la parte homogénea, se multiplica
por la menor potencia entera positiva de $n$ hasta eliminar toda
duplicación.

\subsubsection{El término no homogéneo es exponencial}
\label{sec:exponencial}

Cuando el término no homogéneo es exponencial debemos proponer una
solución de dicho sistema. Por ejemplo: la ecuacion en diferencias
$x_{n+2}+3x_{n+1}+2x_n=3^n$ al resolver el sistema homogéneo
obtenemos la solucion: $x_n=\lambda_1(-2)^n+\lambda_2(-1)^n$, ahora,
para el sistema no homogéneo, debemos proponer una solución la
cual es un múltiplo del término exponencial.En este ejemplo la
solución del sistema no homogéneo es de la forma $A(3)^n$, ya que
tenemos una propuesta, debemos resolver el sistema con $x_n=A(3)^n$.
Veamos la solución:

\begin{align*}
  A(3)^{n+2}+3A(3)^{n+1}+2A(3)^n&=(3)^n\\
  A(3)^2+3A(3)+2A&=1\\
  9A+9A+2A&=1\\
  20A&=1
\end{align*}
De ahí, concluimos que $A=\frac{1}{20}$.
Luego, nuestra solucion $x_n=\frac{1}{20}(3)^n$ la debemos que sumar a las soluciones del sistema homogéneo las cuales quedaran así:
$$x_n=\lambda_1(-2)^n+\lambda_2(-1)^n+\frac{1}{20}(3)^n$$.
Lo unico que nos hace falta es encontrar los valores de $\lambda_1$ y $\lambda_2$ de acuerdo a las condiciones iniciales tal y como se a realizado en ejemplos anteriores.

Tambíen puede pasar que la solución del sistema homogéneo sea la misma del sistema no homogéneo. Por ejemplo: tomando el ejemplo de arriba pero cambiandolo un poco tenemos la ecuacion en diferencias $x_{n+2}+3x_{n+1}+2x_n=(-2)^n$, vemos que $(-2)^n$ es solucion del sistema homogéneo y del no homogéneo, en este caso, la solucion del sistema no homogéneo se propone así $x_n=An(-2)^n$ (el mismo argumento es para cuando el sistema homogéneo tiene un sola solución y el sistema no homogéneo tiene la misma solución, en ese caso la solucion de sistema no homogéneo se propone como $x_n=An^2(-2)^n$), y al resolver queda así:
\begin{align*}
  A(n+2)(-2)^{n+2}+3A(n+1)(-2)^{n+1}+2An(-2)^n&=(-2)^n\\
  A(n+2)(-2)^2+3A(n+1)(-2)+2An&=1\\
  4A(n+2)-6A(n+1)+2An&=1\\
  4An+8A-6An-6A+2An&=1\\
  A(4n+8-6n-6+2n)&=1\\
  A(2)&=1\\
  A&=\frac{1}{2}
\end{align*}
Ahora, procedemos igual que en el ejemplo anterior, es decir, a las soluciones del sistema homogéneo le sumamos una solución del sistema no homogéneo y así ya tendremos todas las soluciones del sistema no homogéneo, quedando así, la solución del sistema homogéneo:
$$x_n=\lambda_1(-2)^n+\lambda_2(-1)^n+\frac{n}{2}(-2)^n$$
\subsubsection{El término no homogéneo es polinomial}
\label{sec:polinomial}

Hay ecuaciones en diferencias que son de la siguiente forma: $a_{n+2}+ba_{n+1}+ca_n=f(n)$, donde $f(n)$ es un polinomio. Por ejemplo, la siguiente suma: $1^2+2^2+...+n^2$, su fórmula puede obtenerse usando una relación de recurrencia, notando que:
$a_1=1$, $a_2=a_1+2^2$, \dots, $a_n=a_{n-1}+n^2$.


De este modo, la relación recursiva queda como sigue:
$a_{n}-a_{n-1}=n^2$.  Como se vio antes, debe resolverse la parte
homogénea de la ecuación ($a_n-a_{n-1}=0$), proponer una solución
particular para la parte no homogénea y posteriormente sumar ambas
soluciones, así, podemos resolver el problema de la siguiente manera:
Resolviendo la parte homogénea de la solución, la ecuación resultante
es: $y_n=\lambda$.

Ahora, usando el método de coeficientes indeterminados, se propone el
siguiente polinomio: $z_n=An^3+Bn^2+Cn$, donde sustituyéndola en
$a_n-a_{n-1}=0$, se obtienen los valores de $A,B,C$.

Usaremos la siguiente expresión:
\begin{equation}
  \label{polinomial}
   An^3+Bn^2+Cn-(A(n-1)^3+B(n-1)^2+C(n-1))=n^2.  
\end{equation}

Realizando algunas operaciones se llega a:
$3An^2+(-3A+2B)n+A-B+C=n^2$.
Como ambos polinomios deben ser iguales, se resuelve el siguiente sistema de ecuaciones:
$3A=1$,
$-3A+2B=0$,
$A-B+C=0$,
Con lo cual: $A=\frac{1}{3}$, $B=\frac{1}{2}$, $C=\frac{1}{6}$.

Sustituyendo los valores en $Z_n$
$z_n=\frac{n^3}{3}$$+\frac{n^2}{2}$$+\frac{n}{6}=$$\frac{n(n+1)(2n+1)}{6}$

Para concluir con el problema, se suman ambas soluciones, obteniendo que:
$a_n=\frac{n(n+1)(2n+1)}{6}$$+\lambda$.
Con lo cual, evaluando con las condiciones iniciales, se obtiene que $\lambda$$=0$.
Así, la solución del problema es:
$a_n=\frac{n(n+1)(2n+1)}{6}$.
%%% ???????????

\end{document}
