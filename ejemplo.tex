\documentclass{report}

\usepackage[spanish, mexico]{babel}

\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{tikz}

\title{Ecuaciones en diferencias}

\author{Alumnos de 3er semestre}

\date{\today}
 
\begin{document}

\maketitle
\tableofcontents

\chapter{Ecuaciones en diferencias}
\label{sec:ecuaciones}

En este documento veremos ecuaciones en diferencias, en especial de
primer y segundo orden homógeneas, al igual que la solución de una
ecuación en diferencias no homógenea que se representa como una suma
de una solución homógenea y una particular. Para dar solución a las
ecuaciones tanto de primer como de segundo orden calcularemos su
ecuación resolvente.
En el caso de las de segundo orden tenemos los casos en donde tenemos una o dos soluciones y tendremos que distinguir los casos en donde obtenemos raíces reales distintas, raíces reales de multiplicidad dos o raíces complejas.

Una ecuación en diferencias es de la forma:
$$X_{n+k}=f(n,X_n,...,X_{n+k-1}),$$
donde $k,n$ son fijos.
\section{Ejemplo}

Si en una ecuación en diferencias, la función $f$ no depende de $n$,
la ecuación en diferencias es \emph{autónoma}.

\chapter{Ecuaciones de primer orden}

\section{Ecuaciones lineales}

Una \emph{ecuación lineal en diferencias de primer orden} tiene la forma:
\begin{equation}
  \label{lineal}
  x_{n+1}=ax_n,
\end{equation}
donde $a$ es una constante.

La fórmula para resolver ecuaciones lineales es:
\begin{equation}
  \label{lineal}
  x_n=a^nx_0.
\end{equation}
Demostración (Por inducción):

Tenemos la condición inicial $x_0$, note que $x_1=ax_0$.  Supongamos
válida la forma para $n$, es decir $x_n=a^nx_0$.Ahora falta mostrar que
la fórmula es válida para $n+1$.

Entonces
\begin{align*}
  x_{n+1}&=ax_n\\
        &=a(a^nx_0)\\
       &=a^{n+1}x_0
\end{align*}

Por lo tanto la fórmula $x_n=a^nx_0$ resuelve la ecuación en
diferencias; $$x_{n+1}=ax_n.$$
Por ejemplo, si consideramos el valor de una inversión de $1000$ pesos
que acumula un interés mensual de $1\%$, obtenemos la gráfica mostrada
en la figura~\ref{inversion}.

\begin{figure}
  \centering
  \includegraphics[width=8cm]{inversion.png}
  \caption{Gráfica de una inversión}
  \label{inversion}
\end{figure}

Siguiendo con el ejemplo, consideramos a $x_n$ como el monto
de la inversión cuando han pasado $n$ meses.  Note que:
\begin{equation}
  \label{eq:2}
  \text{cambio}=\text{valor futuro}-\text{valor presente},
\end{equation}
donde $x_n=\text{valor presente}$ y $x_{n+1}=\text{valor futuro}$.
Como el cambio es de $1\%$ entonces $\text{cambio}=0.01x_n$.  Ocupando
\eqref{eq:2} nos queda que:
\begin{align*}
  0.01x_n&=x_{n+1}-x_n\\
  x_{n+1}&=x_n+0.01x_n\\
 x_{n+1}&=1.01x_n
\end{align*}

Sabemos que las ecuaciones que se ven de esta forma se resuelven con
la fórmula (2).  Entonces $x_n=(1.01)^nx_0$ donde $x_0=1000$.

\section{Ejemplo de elemento radioactivo}

Un elemento radioactivo decae a una razón de $2\%$ cada 20 años.
\begin{itemize}
\item Si inicialmente se tenían 165 gramos de este elemento, ¿cuánto
  se tendrá en 60 años?
 \item ¿Cuál es la vida media de este elemento?
\end{itemize}

\textit{Solución:} Sabemos que la condición inicial es de 165 gramos y
que decae un $2\%$ cada 20 años, lo cual implica que se mantiene en un
$98\%$ con respecto a al valor anterior, entonces la solución de la
ecuación en diferencia es la siguiente:

$$x_{n}=(.98)^n(165).$$

Donde $n=3$, pues buscamos el valor del elemento cuando han pasado 60
años, y éste, decae cada 20 años, por lo tanto el resultado es:
$$x_{3}=(.98)^3(165)= 155.29.$$

\section{Ejemplo de propagación de rumor}

Se esparce nuestro trabajo colaborativo dentro de la universidad. Al
tiempo~0, el trabajo es conocido por 13 personas, además cada persona que
conoce el trabajo le trasmite la informacion a una nueva.

Si $X_n$ es la cantidad de personas que conoce eln trabajo al dia  $n$,
determinar~$X_n$ en términos de $n$ y $X_0=13$.

\textit{Solución:} La ecuación en diferencias está dada por
$X_{n+1}=aX_n$, con el valor~$a=2$.

Note que es conveniente tomar $a=2$ porque se observa que el cambio
está dado por la ecuación $X_{n+1}-X_{n}=X_{n}$, entonces despejando
$X_{n+1}$ se tiene que~$X_{n+1}=2X_n$.

Como $X_0=13$, tendríamos el siguiente razonamiento:
\begin{itemize}
\item $X_0=2^013=13$,
\item $X_1=2^113=26$, siguiendo, llegamos a:
\item $X_n=2^n13=a^nX_0$, quedando de esta manera la solución.
\end{itemize}


\section{Ecuaciones de primer orden no homogéneas}
Encuentre la solución a la siguiente ecuación en diferencias
\begin{equation}
  \label{nohom}
  a_{n+1}=2a_{n}+1,
\end{equation}

con condición inicial $a_{0}=1$.
Observe que la solución homogénea de la ecuación en diferencias  es $a_{n}^h=C2^n$.
Ahora, tenemos que proponer una solución particular a la ecuación no homogénea.
Propongamos:
\begin{align*}
  A&=a_n,\\
  A&=a_{n+1}.
\end{align*}
Sustituyendo en \ref{nohom} nos queda lo siguiente,

\begin{align*}
  a_{n+1}-2a_{n}&=1\\
  1&=A-2A\\
  1&=-A\\
  -1&=A
\end{align*}
De ahi, concluimos que $A=-1$.
Luego, nuestra solucion $a_n^p=-1$ la tenemos que sumar a la solucion del sistema homogéneo las cuales quedaran así:
$a_{n}^h=C2^n-1$
Recuerde nuestra condición inicial $a_{0}=1$. Veamos que:
\begin{align*}
1&=a_{0}=2C-1\\
2C&=2\\
  C&=1
\end{align*}  
por lo tanto, la solución general a la ecuación en diferencias no homogénea es:
$$a_{n}=2^n-1$$


\chapter{Ecuaciones de segundo orden}

Una ecuación en diferencias de segundo orden tiene la forma
\begin{equation}
  \label{ecsegorden1}
  a_{n+2}=f(a_n,a_{n+1}),
\end{equation}
El método para resolver estas ecuaciones está inspirado en la fórmula \eqref{lineal} 

Para resolver una ecuación en diferencias de segundo orden se usa la
ecuación resolvente, la cual se dedujo de la siguiente manera:

En general una ecuación en diferencias de segundo orden líneal y homogénea con coeficientes constates se ve asi: $$ax_{n+2}=-bx_{n+1}-cx_{n}$$ Ésto implica que
\begin{equation}
  \label{ecsegorden}
  ax_{n+2}+bx_{n+1}+cx_{n}=0,
\end{equation}
con $a$, $b$ y $c$ en los reales, entonces como ya mencionamos, el método
para resolver éstas ecuaciones está inspirado en la fórmula \eqref{lineal}
. Ahora, ¿qué deben cumplir~$r$ y~$s$ para que $x_n=sr^n$
sea solución de la ecuación \eqref{ecsegorden}?

Tenemos entonces que: $x_{n+2}=sr^{n+2}$, $x_{n+1}=sr^{n+1}$ y
$x_{n}=sr^{n}$, luego~$asr^{n+2}+bsr^{n+1}+csr^n=0$, ésto implica que
$s(r^{n+2}+br^{n+1}+cr^n)=0$, se sigue $r^n (r^2+br+c)=0$, para todo
$n$, así tenemos que $r^2+br+c=0$ a la cual llamaremos
\textit{ecuación resolvente} de la ecuación \eqref{ecsegorden} y
$x^n=r^n$ es solución de la ecuación \eqref{ecsegorden}.



\section{Dos soluciones distintas}
\label{sec:distintas}
La forma en la que resolvemos una ecuación de segundo orden cuya
ecuación resolvente tenga dos raíces distintas es mediante la
siguiente formula:
\begin{equation}
 \label{raicesdistintas}
 a_n=\alpha_1r_1^n +\alpha_2r_2^n,
\end{equation}
donde $r_1$ y $r_2$ son soluciones de la ecuación de segundo orden y
$\alpha_1$ y $\alpha_2$ son escalares reales.
\subsection{Ejemplo}

Una de las ecuaciones de segundo grado más famosas es la \textit{sucesión de
  Fibonacci}, la cual es:
\begin{equation}
  \label{eq:fibonacci}
F_{n+2}=F_{n+1}+F_{n},  
\end{equation}
en donde usualmente se toman como condiciones iniciales a: $F_{0}=1$ y $F_{1}=1$

Es inmediato calcular los primeros términos, pero ¿cómo calcularlos
cuando los términos son demasiado grandes?  Para obtenerlos,
consideramos la ecuación resolvente que viene de la ecuación original,
la cual se ve de la siguiente manera:
$$r^2-r-1=0$$

Obtenemos después ambas raíces, las cuales son:
$r_{1}= \frac{1+\sqrt{5}}{2}$ y $r_{2}=\frac{1-\sqrt{5}}{2}$. La
solución general es entonces:
$F_{n}=\alpha_{1}(\frac{1+\sqrt{5}}{2})^{n} +
\alpha_{2}(\frac{1-\sqrt{5}}{2})^n$.
Ahora resolvemos un sistema de ecuaciones tal que:
\begin{align*}
\alpha_{1} + \alpha_{2} &= 1\\
(\frac{1+\sqrt{5}}{2})\alpha_{1} + (\frac{1+\sqrt{5}}{2})\alpha_{2}&=1
\end{align*}
Para obtener finalmente:
  $$F_{n} &= \frac{1}{\sqrt{5}}((\frac{1+\sqrt{5}}{2})^{n+1}-(\frac{1-\sqrt{5}}{2})^{n+1})$$

\subsection{Ejemplo}
\label{sec:fichas}

¿De cuántas maneras se puede cubrir un tablero de $2\times n$ usando
fichas de $1\times 2$ y $2\times 1$?

\textit{Solución:} Sea $a_n$ la cantidad de maneras con las cuales se
puede cubrir el tablero $2\times n$. Ahora, si tenemos un tablero
$2\times (n+1)$, observemos que hay una sola manera de cubrir la
casilla que se le agregó y esta es usando una ficha $2\times 1$.
Después utilizando el mismo razonamiento con un tablero
$2\times (n+2)$ tenemos que las dos casillas agregadas se pueden
cubrir de 2 formas, sin embargo, una es usando fichas $1\times 2$ y la
otra es usando fichas $2\times 1$, la cual ya se contempló en el caso
anterior. Por lo tanto solo consideramos el caso restante, obteniendo
así la siguiente ecuación en diferencias de segundo orden:
$a_{n+2}=a_{n+1}+a_n$. Por la ecuación \eqref{eq:fibonacci}, tenemos
que $r_1=(\frac{1+\sqrt{5}}{2})^n$ y $r_2=(\frac{1-\sqrt{5}}{2})^n$
son soluciones de la ecuación, por lo tanto
$a_n=\alpha_1(\frac{1+\sqrt{5}}{2})^n +
\alpha_2(\frac{1-\sqrt{5}}{2})^n$ es solución general de la ecuación.


Es fácil deducir que para $n=1$ solo hay una manera de cubrir el
tablero, y para $n=2$ hay 2 maneras de cubrir el tablero, por lo tanto
las condiciones iniciales son $a_1=1$ y $a_2=2$

Ahora, para resolver el problema tenemos que encontrar $\alpha_1$ y
$\alpha_2$ que cumplan con las condiciones iniciales, entonces hay que
resolver el sistema:

\begin{align*}
\alpha_{1} + \alpha_{2} &= 1\\
(\frac{1+\sqrt{5}}{2})\alpha_{1} + (\frac{1+\sqrt{5}}{2})\alpha_{2}&=1
\end{align*}
Para obtener finalmente:
$a_{n}= \frac{5+\sqrt{5}}{10}(\frac{1+\sqrt{5}}{2})^n +
\frac{5-\sqrt{5}}{10}(\frac{1-\sqrt{5}}{2})^n$.

\section{Una única solución}
\label{sec:unica}

Para resolver una ecuación en diferencias de segundo orden cuya
ecuación resolvente tenga dos raíces iguales usamos la siguiente fórmula:
\begin{equation}
 \label{raicesiguales}
 a_n=\alpha_1r_1^n +\alpha_2nr_2^n,
\end{equation}
donde $r_1=r_2$ son soluciones de la ecuación de segundo orden y
$\alpha_1$ y $\alpha_2$ son escalares reales.

\subsection{Primer ejemplo}

En la siguiente ecuación en diferencias
\begin{equation}
  \label{eq:1}
  x_{n+2}=4x_{n+1}-4x_{n}
\end{equation}
veremos que la ecuación resolvente $r^2-4r+4=0$ tiene una sola raíz, a
saber: $r=2$.

La solución general es entonces:
$$x_n=\alpha_12^n+\alpha_2n2^n$$
y a continuación se deben considerar los valores iniciales para que
nos dé los valores de $\alpha_1$ y $\alpha_2$.

Por ejemplo, si tuviéramos $x_0=-1,x_1=5$ y una ecuacion en diferencias como:

$x_{n+2}=2x_{n+1}-x_n$

\subsection{Segundo ejemplo}

Se plantea la siguiente ecuación en diferencias:
$a_{n+2}=2a_{n+1}-a_{n}$ con condiciones iniciales: $a_{0}=4, a_{1}=7$.

Para resolver este problema, primero igualamos la ecuación en diferencias a
cero: $a_{n+2}-2a_{n+1}+a_{n}=0$.

Esto último nos genera una ecuación resolvente. Al factorizarlas y
resolverla se obtiene: $r^2-2r+1=0$, $(r-1)^2=0$, ${r=1}$.

La solución general a esta ecuación en diferencias sería:



$$a_{n}=\alpha_{1}(1)^n+n\alpha_{2}(1)^n=\alpha_{1}+n\alpha_{2}$$

Sin embargo, el problema nos da condiciones iniciales
específicas. Entonces procedemos a plantear un sistema de ecuaciones
para poder satisfacer las condiciones iniciales.
\begin{align*}
  a_{0}&=4=\alpha_{1}(1)^0+0\alpha_{2}(1)^0\\
  a_{1}&=7=\alpha_{1}(1)^1+1\alpha_{2}(1)^1
\end{align*}

Al resolver lo anterior obtenemos los siguientes valores:
$\alpha_{1}=4$ y $\alpha_{2}=3$, con lo que la solución final será:
$a_{n}=4+3n$.


\section{Los números  complejos}

Un \textit{complejo} es un número de la forma $z=a+bi$, $a,b\in\mathbb{R}$ ,
con $i^2=-1$, y donde $a$ recibe el nombre de \textit{parte real} y $b$ el de
\textit{parte imaginaria}

El \textit{módulo} de un número complejo se define como:
$|a+bi|=\sqrt{a^2+b^2}$, agarrando las partes reales, el módulo
siempre es positivo.

El \textit{argumento} de un número complejo se denota así: $\arg(z)=\theta$. Es
el ángulo comprendido en el plano tanto en el eje real
($x\in\mathbb{R}$) como el eje imaginario ($y\in\mathbb{R}$), como se puede observar en la siguiente figura:
\begin{center}
\begin{tikzpicture}
  \draw (0,0) circle(2);
  \draw[brown, very thick] (0,0) -- (2.5,0);
  \draw(-2.5,0) -- (0,0);
  \draw (0,2.5) -- (0,-2.5);
  \draw[brown, very thick] (0,0) -- (45:2);
  \draw[brown, very thick] (0.5,0) arc (0:45:0.5);
  \draw(1,0.3) node {$\arg z$};
  \draw(1.8,1.5) node {$z$};
\end{tikzpicture}
\end{center}
Para calcularlo decimos que:
$z=|z|*\frac{z}{|z|}$, ahora que tenemos eso podemos ver a $z$ como
$z=\cos(\theta)+i\sin(\theta)$.

Para obtener el valor de $\theta$
necesitamos la siguiente fórmula: $\theta=\arctan(\arg(z))$. Teniendo el
valor de $\theta$ podemos sustituirla en nuestra ecuación principal
$z=\cos(\theta)+i\sin(\theta)$. Para tener una solución en términos de
$n$ tenemos que elevar toda nuestra fórmula a la $n$, es decir
$z^n=(\cos(\theta)+i\sin(\theta))^n$, esto es igual que decir
$z^n=\cos(n\theta)+i\sin(n\theta)$ (utilizando la fórmula de Moivre).

\section{Soluciones complejas}
\label{sec:complejas}

Algunas ocasiones las ecuaciones de segundo orden no tendrán solución
en los reales, sin embargo en los complejos sí y no por manejar
números complejos su nivel de dificultad será mayor. Aquí mostramos un
ejemplo de soluciones complejas: 

\begin{align*}
x_{n+2}=-4x_{n} con x_0=1 y x_1=0.
\end{align*}
La ecuación resolvente es: $r^2+4=0$, la cual tiene raíces complejas.
Resolvemos igual que en ecuaciones de segundo orden entonces aplicamos
la formula general para buscar sus raíces y tenemos: $r_1=2i,r_2=-2i$.

y como la forma polar de $r_1$
se ve como:

\begin{align*}
2i=|2|(\cos((\frac{\pi}{2}))+i\sen((\frac{n\pi}{2}))
\end{align*}

Ahora buscaremos su módulo: $|r_{1}|=\sqrt{2^2}=2$

Llegado a este punto hacemos uso de la fórmula resolvente y la fórmula de De Moivre para obtener lo siguiente:

$x_n=\lambda_12^n\cos(\frac{n\pi}{2})+\lambda_22^n\sin(\frac{n\pi}{2})$.


Y buscamos el valor de los lambdas con un sistema de ecuaciones:
\begin{align*}
\lambda_12^0\cos(\frac{0\pi}{2})+\lambda_22^0\sin(\frac{0\pi}{2})&=1\\
\lambda_12^1\cos(\frac{1\pi}{2})+\lambda_22^1\sin(\frac{1\pi}{2})&=0
\end{align*}
Al resolver obtenemos los siguientes valores:

$\lambda_1=1;\lambda_2=0$

con lo que la solución final es:

$x_n=2^n\cos(\frac{n\pi}{2})$
\bigskip
\bigskip
\subsection{Ejemplo}

Ecuación en diferencias con suluciones complejas

$$x_{n+2}=4x_{n+1}-8x_{n}$$,

con condiciones iniciales $x_{0}=-1$ y $x_{1}=1$

 La ecuación resolvente del problema es

 $$r^2-4r+8=0$$

 con soluciones $r_{1}=2+2i$ $r_{2}=2-2i$.

\bigskip

 Tomamos a $r_{1}$ para que una solución particular de la ecuación en diferencias sea $$x_{n}=(2+2i)^n$$

Necesitamos a la parte real y la parte imaginaria de $(2+2i)^n$. Obtenemos el módulo de $r_{1}$ que resultaría $|r|= \sqrt{32}$ y obtenemos el $\arg(r_{1})=\frac{\pi}{4}$.

Entonces, ocupando la fórmula de Moivre, se tiene que

$$r_{1}^n=(\sqrt{32})^n(\cos{\frac{n\pi}{4}}+i\sin{\frac{n\pi}{4}})$$


Tomamos la parte real y la parte entera de $r_{1}^n$:

$\mathrm{Re}(r_{1})=(\sqrt{32})^n\cos{\frac{n\pi}{4}}$ y $\mathrm{Im}(r_{1})=(\sqrt{32})^n\sin{\frac{n\pi}{4}}$

  Entonces haciendo uso de la fórmula resolvente obtenemos que

  $$x_{n}=\alpha_{1}(\sqrt{32})^n\cos{\frac{n\pi}{4}} + \alpha_{2}(\sqrt{32})^n\sin{\frac{n\pi}{4}}$$

    Encontramos a los alphas con un sistema de ecuaciones planteado usando a las condiciones iniciales

    $$x_{0}=-1=\alpha_{1}(\sqrt{32})^0\cos{\frac{0\pi}{4}} + \alpha_{2}(\sqrt{32})^0\sin{\frac{0\pi}{4}}$$
      
     $$x_{1}=1=\alpha_{1}(\sqrt{32})^1\cos{\frac{1\pi}{4}} + \alpha_{2}(\sqrt{32})^1\sin{\frac{1\pi}{4}}$$

        Obteniendo que $\alpha_{1}=-1$ y que $\alpha_{2}=\frac{5}{4}$

        Por último la solución
 es:

         $$x_{n}=\-(\sqrt{32})^n\cos{\frac{n\pi}{4}} + \frac{5}{4}(\sqrt{32})^n\sin{\frac{n\pi}{4}}$$


\subsection{Ejemplo}

Para cada $n$, considera $D_{n}$ el determinante $n\times n$ dado por:

\begin{equation*}
\begin{pmatrix}
0 & 1 & 0 & 0 &\ldots & 0 & 0 & 0 & 0\\
1 & 0 & 1 & 0 &\ldots & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 1 &\ldots & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 &\ldots & 0 & 0 & 0 & 0\\
\ldots\\
0 & 0 & 0 & 0 &\ldots & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 &\ldots & 1 & 0 & 1 & 0\\
0 & 0 & 0 & 0 &\ldots & 0 & 1 & 0 & 1\\
0 & 0 & 0 & 0 &\ldots & 0 & 0 & 1 & 0
\end{pmatrix}
\end{equation*}


Para encontrar $D_{n}$ usamos la ecuación en diferencias que se deduce de observar
que $D_{n}=(0)D_{n-1}-(1)D_{n-2}$ entonces;
\begin{equation}
  \label{determinante}
D_{n}=-D_{n-2}
\end{equation}
 y además $D_{0}=0$ y $D_{1}=-1$.
Resolvamos la ecuación resolvente que es $$r^{2}=-1$$ y asi las soluciones son $r_{1}=i$ y  $r_{2}=-i$.

Veamos que  $|i|=\sqrt{1}=1$ y que $\arg(\theta)$ y $\theta= \frac{\pi}{2}$, de ahí:
$$i=\cos(\frac{\pi}{2})+i\sin(\frac{\pi}{2})$$
Elevando a la $n$ se obtiene
$$i^n=(\cos(\frac{\pi}{2})+i\sin(\frac{\pi}{2}))^{n}$$
Usando la Formula de De Moivre se obtiene:
$$i^n=\cos(\frac{n\pi}{2})+i\sin(\frac{n\pi}{2})$$

De lo cual se tiene que, $\cos(\frac{\pi}{2})$ y  $\sin(\frac{\pi}{2})$ son soluciones de la ecuación en diferencias, entonces: 
$$D_{n}=\alpha_{1}\cos(\frac{n\pi}{2})+\alpha_{2}\sin(\frac{n\pi}{2})$$
Ahora resolvamos un pequeño sistema de ecuaciones para conocer los valores de $\alpha_1$ y $\alpha_2$:
  $$D_{0}=\alpha_{1}(1)+\alpha_{2}(0)=\alpha_{1}=1$$
  $$D_{1}=\alpha_{1}(0)+\alpha_{2}(1)=\alpha_{2}=0$$

Finalmente la solución general a la ecuación en diferencias es:
\begin{equation}
  \label{solucion determinante}
D_{n}=\cos(\frac{n\pi}{2}).
\end{equation}


\subsection{Ejemplo}

Para cada $n$, considera $D_{n}$ el determinante $n\times n$ dado por:

\begin{equation*}
\begin{pmatrix}
1 & 1 & 0 & 0 &\ldots & 0 & 0 & 0 & 0\\
1 & 1 & 1 & 0 &\ldots & 0 & 0 & 0 & 0\\
0 & 1 & 1 & 1 &\ldots & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 1 &\ldots & 0 & 0 & 0 & 0\\
\ldots\\
0 & 0 & 0 & 0 &\ldots & 1 & 1 & 0 & 0\\
0 & 0 & 0 & 0 &\ldots & 1 & 1 & 1 & 0\\
0 & 0 & 0 & 0 &\ldots & 0 & 1 & 1 & 1\\
0 & 0 & 0 & 0 &\ldots & 0 & 0 & 1 & 1
\end{pmatrix}
\end{equation*}


Para calcular $D_{n}$ utilisamos la ecuación en diferencias;
\begin{equation}
  \label{determinante}
D_{n+2}=(b)D_{n+1}-(b^2)D_{n}
\end{equation}
 y además $D_{1}=b$ y $D_{2}=0$.
Resolvemos la ecuación resolvente $$r^{2}-br+b^2=0$$ y así una solución es $r=\frac{b(1+i \sqrt{3})}{2}$.

De ahí que
  $$r=b(\cos(\frac{\pi}{3})+i\sin(\frac{\pi}{3}))$$
  $$r^n=b^n(\cos(\frac{n\pi}{3})+i\sin(\frac{n\pi}{3}))$$
  $$D_{n}=\alpha_{1}b^n\cos(\frac{n\pi}{3})+\alpha_{2}b^n\sin(\frac{n\pi}{3})$$
  $$D_{1}=\alpha_{1}(1)+\alpha_{2}(\sqrt{3})$$
  $$D_{2}=\alpha_{1}(-1)+\alpha_{2}(\sqrt{3})$$
  $$\alpha_{1}=1$$
  $$\alpha_{2}=\frac{1}{\sqrt{3}}$$
Finalmente la solución es:
\begin{equation}
  \label{solucion determinante}
D_{n}=b^n(\cos(\frac{n\pi}{3})+\frac{\sin(\frac{n\pi}{3})}{\sqrt{3}}).
\end{equation}

\subsubsection{Ejemplo 2}
REsuelve la ecuación en diferencias $x_{n+2}=4x_{n+1}-8x_n$ con condiciones iniciales $x_0=-1$ y $x_1=1$.

\textit{Solución:} 
Igualamos la ecuación a cero.
$$x_{n+2}-4x_{n+1}+8x_n=0$$

Y obtenemos la ecuación resolvente, que es: 
$$r^2-4r+8=0$$

Pra encontrar las raíces de la ecuación aplicamos la fórmula general de segundo grado, con los valores $a=1$, $b=-4$ y $c=8$

\begin{align*}
  r_{1,2}&=\frac{-(-4)\pm\sqrt{(-4)^2-4(1)(8)}}{2(1)}\\
  &=\frac{4\pm\sqrt{16-32}}{2}\\
  &=\frac{4\pm\sqrt{-16}}{2}\\
  &=\frac{4\pm i\sqrt{16}}{2}\\
  &=\frac{4\pm i4}{2}\\
  &=2\pm 2i
\end{align*}

Entonces las raíces serían:
\begin{align*}
  r_1&=2+2i\\
  r_2&=2-2i
\end{align*}

Para poder encontrar la formula que resuelva la ecuación solo necesitamos trabajar con una de sus raíces. Gráficamos entonces $2+2i$ en el plano complejo y notamos que el ángulo de dicho número complejo es $\alpha=\frac{\pi}{4}$.

Calculamos el módulo.
\begin{align*}
  |r|&=\sqrt{2^2+2^2}\\
     &=\sqrt{4+4}\\
     &=\sqrt{8}
\end{align*}

\begin{align*}
  x_n=(2+2i)&=(\sqrt{8}(\cos(\frac{\pi}{4}))+i \sin(\frac{\pi}{4}))^n\\
  &=(\sqrt{8})^n(\cos(\frac{n\pi}{4})+i \sin(\frac{n\pi}{4})))\\
  &=(\sqrt{8})^n(\cos(\frac{n\pi}{4}))+i (\sqrt{8})^n(\sin(\frac{n\pi}{4}))\\
  &=\alpha_1(\sqrt{8})^n(\cos(\frac{n\pi}{4}))+\alpha_2(\sqrt{8})^n(\sin(\frac{n\pi}{4}))
\end{align*}

Para $n=0$, cuando $x_0=-1$:
\begin{align*}
  x_0&=\alpha_1(\sqrt{8})^0(\cos(\frac{0\pi}{4}))+\alpha_2(\sqrt{8})^0(\sin(\frac{0\pi}{4}))\\
  &=\alpha_1(1)(\cos(0))+\alpha_2(1)(\sin(0))\\
  &=\alpha_1(1)(1)+\alpha_2(1)(0)\\
  &=\alpha_1
\end{align*}

Para $n=1$, cuando $x_1=1$:
\begin{align*}
  x_0&=\alpha_1(\sqrt{8})^1(\cos(\frac{\pi}{4}))+\alpha_2(\sqrt{8})^1(\sin(\frac{\pi}{4}))\\
  &=\alpha_1(\sqrt{8})(\frac{\sqrt{2}}{2})+\alpha_2(\sqrt{8})(\frac{\sqrt{2}}{2})\\
  &=(-1)(\sqrt{8})(\frac{\sqrt{2}}{2})+\alpha_2(\sqrt{8})(\frac{\sqrt{2}}{2})\\
  &=-(\sqrt{8})(\frac{\sqrt{2}}{2})+\alpha_2(\sqrt{8})(\frac{\sqrt{2}}{2})\\
  &=\alpha_2
\end{align*}

Finalmente, la formula que resuelve la ecuación es:
$$x_n=-(\sqrt{8})^n(\cos(\frac{n\pi}{4}))+(\sqrt{8})^n(\sin(\frac{n\pi}{4}))$$.

\section{Ecuaciones de segundo orden no homogéneas}
\label{sec:nohomogeneas}

Para resolver la ecuación representada por la expresión
$$ax_{n+2}+bx_{n+1}+cx_{n}=f(n)$$ debemos sumar una solución particular
del problema no homogéneo a la solución obtenida de resolver la parte
homogénea.

Cuando la solución particular del problema no homogéneo que estamos
presentando también es solución de la parte homogénea, se multiplica
por la menor potencia entera positiva de $n$ hasta eliminar toda
duplicación.

\subsection{El término no homogéneo es exponencial}
\label{sec:exponencial}

Cuando el término no homogéneo es exponencial debemos proponer una
solución de dicho sistema. Por ejemplo: la ecuacion en diferencias
$$x_{n+2}+3x_{n+1}+2x_n=3^n$$ al resolver el sistema homogéneo
obtenemos la solucion:
$$x_n=\lambda_1(-2)^n+\lambda_2(-1)^n$$, ahora,
para el sistema no homogéneo, debemos proponer una solución la
cual es un múltiplo del termino exponencial. En este ejemplo la
solución del sistema no homogéneo es de la forma $A(3)^n$ ya que
tenemos una propuesta, debemos resolver el sistema con $x_n=A(3)^n$,
veamos la solución:

\begin{align*}
  A(3)^{n+2}+3A(3)^{n+1}+2A(3)^n&=(3)^n\\
  A(3)^2+3A(3)+2A&=1\\
  9A+9A+2A&=1\\
  20A&=1
\end{align*}
De ahí, concluimos que $A=\frac{1}{20}$.
Luego, a nuestra solución del sistema no homogéneo  $x_n=\frac{1}{20}(3)^n$ le debemos sumar las soluciones del sistema homogéneo, de lo cual se obtiene:
$$x_n=\alpha_1(-2)^n+\alpha_2(-1)^n+\frac{1}{20}(3)^n.$$

Lo único que nos hace falta es encontrar los valores de $\alpha_1$ y $\alpha_2$ de acuerdo a las condiciones iniciales.

También puede pasar que la solución del sistema homogéneo sea la misma del sistema no homogéneo. Por ejemplo: tomando el ejemplo de arriba pero cambiándolo un poco tenemos la ecuacion en diferencias $x_{n+2}+3x_{n+1}+2x_n=(-2)^n$, vemos que $(-2)^n$ es solución del sistema homogéneo y del no homogéneo, en este caso, la solución del sistema no homogéneo se propone así $x_n=An(-2)^n$ (el mismo argumento es para cuando el sistema homogéneo tiene una sola solución y el sistema no homogéneo tiene la misma solución, en ese caso la solución de sistema no homogéneo se propone como $x_n=An^2(-2)^n$), y al resolver queda la siguiente manera:
\begin{align*}
  A(n+2)(-2)^{n+2}+3A(n+1)(-2)^{n+1}+2An(-2)^n&=(-2)^n\\
  A(n+2)(-2)^2+3A(n+1)(-2)+2An&=1\\
  4A(n+2)-6A(n+1)+2An&=1\\
  4An+8A-6An-6A+2An&=1\\
  A(4n+8-6n-6+2n)&=1\\
  A(2)&=1\\
  A&=\frac{1}{2}
\end{align*}
Ahora, procedemos igual que en el ejemplo anterior. Es decir, a las soluciones del sistema homogéneo le sumamos una solución del sistema no homogéneo (la solución particular). De esta manera ya tendrémos todas las soluciones del sistema no homogéneo, quedando así, la solución del sistema homogéneo:
$$x_n=\alpha_1(-2)^n+\alpha_2(-1)^n+\frac{n}{2}(-2)^n$$
\subsection{El término no homogéneo es polinomial}
\label{sec:polinomial}

Hay ecuaciones en diferencias que son de la siguiente forma: $ax_{n+2}+bx_{n+1}+cx_n=f(n)$, donde $f(n)$ es un polinomio. Por ejemplo, la siguiente suma: $1^2+2^2+...+n^2$, su fórmula puede obtenerse usando una relación de recurrencia, notando que:
$a_1=1$, $a_2=a_1+2^2$, \dots, $a_n=a_{n-1}+n^2$.


De este modo, la relación recursiva queda como sigue:
$a_{n}-a_{n-1}=n^2$.  Como se vio antes, debe resolverse la parte
homogénea de la ecuación ($a_n-a_{n-1}=0$), proponer una solución
particular para la parte no homogénea. Posteriormente sumar ambas
soluciones; mediante este procedimiento se llega a la solución del problema.
Resolviendo la parte homogénea de la solución, la ecuación resultante
es: $a^h_n=\lambda$.

Ahora, usando el método de coeficientes indeterminados, se propone el
siguiente polinomio: $a^p_n=An^3+Bn^2+Cn$, donde sustituyéndola en
$a_n-a_{n-1}=0$, se obtienen los valores de $A,B,C$.

Usaremos la siguiente expresión:
\begin{equation}
  \label{polinomial}
   An^3+Bn^2+Cn-(A(n-1)^3+B(n-1)^2+C(n-1))=n^2.  
\end{equation}

Realizando algunas operaciones se llega a:
$$3An^2+(-3A+2B)n+A-B+C=n^2$$.
Como ambos polinomios deben ser iguales, se resuelve el siguiente sistema de ecuaciones:
$3A=1$,
$-3A+2B=0$,
$A-B+C=0$,
Con lo cual: $A=\frac{1}{3}$, $B=\frac{1}{2}$, $C=\frac{1}{6}$.

Sustituyendo los valores en $a^p_n$, se tiene que:
$a^p_n=\frac{n^3}{3}$$+\frac{n^2}{2}$$+\frac{n}{6}=$$\frac{n(n+1)(2n+1)}{6}$

Para concluir con el problema, se suman ambas soluciones, obteniendo que:
$a_n=\frac{n(n+1)(2n+1)}{6}$$+\lambda$.
Con lo cual, evaluando con las condiciones iniciales, se obtiene que $\lambda$$=0$.
Así, la solución del problema es:
$a_n=\frac{n(n+1)(2n+1)}{6}$.
%%% ???????????

\end{document}



